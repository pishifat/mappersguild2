import{d as S,m as A,_ as C,o,e as i,a as s,i as h,t as u,j as b,k as l,n as M,q as P,u as F,x as D,b as w,Y as V,s as q,A as Q,F as y,r as v,c as p,M as E,T as L,Z as T,w as R,y as H,z as N,l as O}from"./index-eb6dff86.js";import{M as j}from"./ModalDialog-6e969adc.js";import{F as z}from"./FilterBox-d0bef02a.js";import{M as J,F as G}from"./extras-c56a8791.js";const W=S({name:"UserCard",props:{user:{type:Object,required:!0}},computed:A("users",["filterMode"]),methods:{selectUser(){this.$store.commit("users/setSelectedUserId",this.user.id)}}});const K=e=>(F("data-v-096980af"),e=e(),D(),e),Y=["src"],Z={class:"mb-2"},X={class:"text-secondary"},x={class:"card-text small"},ee={class:"card-text small"},se=K(()=>s("i",{class:"fas fa-coins"},null,-1)),te={key:0,class:"card-text small"},oe={key:1,class:"card-text small"},ie={key:2,class:"card-text small"},re={key:3,class:"card-text small"};function ne(e,t,n,a,f,g){const d=P("user-link");return o(),i("div",{class:"col-sm-6 col-md-4 col-lg-4 col-xl-3 my-2",onClick:t[0]||(t[0]=_=>e.selectUser())},[s("div",{class:M(["card card-hover card-level-2 card-body","border-rank-"+e.user.rank]),"data-bs-toggle":"modal","data-bs-target":"#extendedInfo"},[s("img",{src:"https://a.ppy.sh/"+e.user.osuId,class:"card-avatar-img"},null,8,Y),s("div",Z,[h(d,{user:e.user},null,8,["user"])]),s("div",X,[s("div",x,[s("b",null,"Total points: "+u(e.user.totalPoints),1)]),s("div",ee,[b(" Available points: "+u(e.user.availablePoints)+" ",1),se]),e.filterMode=="osu"?(o(),i("p",te," osu! points: "+u(Math.round(e.user.osuPoints*10)/10),1)):e.filterMode=="taiko"?(o(),i("p",oe," osu!taiko points: "+u(Math.round(e.user.taikoPoints*10)/10),1)):e.filterMode=="catch"?(o(),i("p",ie," osu!catch points: "+u(Math.round(e.user.catchPoints*10)/10),1)):e.filterMode=="mania"?(o(),i("p",re," osu!mania points: "+u(Math.round(e.user.maniaPoints*10)/10),1)):l("",!0)])],2)])}const ae=C(W,[["render",ne],["__scopeId","data-v-096980af"]]),le=S({name:"UserListElement",props:{user:{type:Object,required:!0}},computed:{...A("users",["filterMode"])},methods:{selectUser(){this.$store.commit("users/setSelectedUserId",this.user.id)},getCover(){var e;return this.user?this.user.cover?`url(${(e=this.user.cover)==null?void 0:e.url})`:`url(https://a.ppy.sh/${this.user.osuId})`:""}}});const de=e=>(F("data-v-7e80120c"),e=e(),D(),e),ce={class:"row"},ue={class:"col-sm-4"},pe=["src"],he={class:"col-sm-4 text-secondary"},me={class:"card-text small"},ge={class:"col-sm-4 text-secondary"},fe={key:0,class:"card-text small"},ye=de(()=>s("i",{class:"fas fa-coins"},null,-1)),_e={key:1,class:"card-text small"},be={key:2,class:"card-text small"},ke={key:3,class:"card-text small"},$e={key:4,class:"card-text small"};function Ue(e,t,n,a,f,g){const d=P("user-link"),_=q("bs-tooltip");return o(),i("div",{class:M(["card card-body card-level-2 p-2","left-border-rank-"+e.user.rank]),style:V(e.user.rank>=3?{background:`linear-gradient(90deg, #3c3b39 15%, rgba(0, 0, 0, 0.82) 140%), ${e.getCover()} center no-repeat`,backgroundSize:"cover"}:""),"data-bs-toggle":"modal","data-bs-target":"#extendedInfo",onClick:t[0]||(t[0]=c=>e.selectUser())},[s("div",ce,[s("div",ue,[e.user.rank?w((o(),i("i",{key:0,class:M(["fas fa-crown mx-1 me-2","text-rank-"+e.user.rank])},null,2)),[[_,`rank ${e.user.rank} user`]]):l("",!0),s("img",{src:"https://a.ppy.sh/"+e.user.osuId,class:"list-avatar-img"},null,8,pe),h(d,{class:"ms-1",user:e.user},null,8,["user"])]),s("div",he,[s("div",me,[b(" Total points: "),s("b",null,u(e.user.totalPoints),1)])]),s("div",ge,[e.filterMode=="any"?(o(),i("div",fe,[b(" Available points: "+u(e.user.availablePoints)+" ",1),ye])):l("",!0),e.filterMode=="osu"?(o(),i("div",_e,[b(" osu! points: "),s("b",null,u(Math.round(e.user.osuPoints*10)/10),1)])):e.filterMode=="taiko"?(o(),i("div",be,[b(" osu!taiko points: "),s("b",null,u(Math.round(e.user.taikoPoints*10)/10),1)])):e.filterMode=="catch"?(o(),i("div",ke,[b(" osu!catch points: "),s("b",null,u(Math.round(e.user.catchPoints*10)/10),1)])):e.filterMode=="mania"?(o(),i("div",$e,[b(" osu!mania points: "),s("b",null,u(Math.round(e.user.maniaPoints*10)/10),1)])):l("",!0)])])],6)}const Pe=C(le,[["render",Ue],["__scopeId","data-v-7e80120c"]]);var U=(e=>(e.ExtendDeadline="extendDeadline",e.AcceptQuest="acceptQuest",e.ReopenQuest="reopenQuest",e.CreateQuest="createQuest",e.RerollShowcaseMissionSong="rerollShowcaseMissionSong",e.RerollShowcaseMissionArtist="rerollShowcaseMissionArtist",e))(U||{});const ve=S({name:"UserPointsRow",props:{points:{type:Number,required:!0},display:{type:String,required:!0},tooltipTitle:{type:String,required:!0}}}),we={class:"text-secondary"},Me={scope:"row"},Se={scope:"row"};function Ce(e,t,n,a,f,g){const d=q("bs-tooltip");return o(),i("tr",we,[w((o(),i("td",Me,[b(u(e.display),1)])),[[d,e.tooltipTitle,"left"]]),s("td",Se,u(Math.round(e.points*10)/10),1)])}const Ae=C(ve,[["render",Ce]]),qe=S({props:{points:{type:Number,required:!0},bgClass:{type:String,required:!0},tooltipText:{type:String,required:!0},displayText:{type:String,required:!0},badge:{type:String,default:"main"}},computed:{...Q("users",["selectedUser"]),maxPoints(){if(this.badge=="mission")return this.selectedUser.completedMissions.length>3?this.selectedUser.completedMissions.length:3;let e;switch(this.selectedUser.rank){case 0:e=100;break;case 1:e=250;break;case 2:e=500;break;case 3:e=1e3;break;case 4:e=2500;break;case 5:e=this.selectedUser.totalPoints;break}return e}},methods:{generateWidth(e){return`width: ${e/(this.maxPoints/100)}%;`},generateTooltipText(){return this.badge=="main"?`${this.tooltipText} (${Math.round(this.points)} points)`:this.tooltipText},generateDisplayText(){return this.badge=="main"?`${this.displayText} (${Math.round(this.points)} points)`:this.displayText}}});const Ie={class:"segment-text"};function Re(e,t,n,a,f,g){const d=q("bs-tooltip");return w((o(),i("div",{key:e.$route.query.id,class:M(["segment",e.bgClass]),style:V(e.generateWidth(e.points))},[s("span",Ie,u(e.generateDisplayText()),1)],6)),[[d,e.generateTooltipText()]])}const Te=C(qe,[["render",Re],["__scopeId","data-v-6d7df64b"]]),Qe=S({name:"RewardProgress",components:{RewardProgressSegment:Te},props:{badge:{type:String,required:!0}},data(){return{bgOptions:["bg-easy","bg-normal","bg-hard","bg-insane","bg-expert","bg-rank-0","bg-rank-1","bg-rank-2","bg-rank-3","bg-rank-4","bg-wip","bg-qualified","bg-done","bg-open","bg-ranked","bg-blocked"]}},computed:{...Q("users",["selectedUser"]),maxPoints(){if(this.badge=="mission")return this.selectedUser.completedMissions.length>3?this.selectedUser.completedMissions.length:3;let e;switch(this.selectedUser.rank){case 0:e=100;break;case 1:e=250;break;case 2:e=500;break;case 3:e=1e3;break;case 4:e=2500;break;case 5:e=this.selectedUser.totalPoints;break}return e}}});const Fe={class:"d-flex mb-2"},De={href:"https://osu.ppy.sh/wiki/en/Community/Mappers_Guild#rewards",target:"_blank"},Be=["src"],Ne={href:"https://osu.ppy.sh/wiki/en/Community/Mappers_Guild#rewards",target:"_blank",class:"ms-auto"},Oe=["src"],Ge={href:"/missions",target:"_blank",class:"mt-3"},Ve=["src"],Ee={class:"progress-bar osu-badge"};function Le(e,t,n,a,f,g){const d=P("reward-progress-segment"),_=q("bs-tooltip");return o(),i(y,null,[s("div",Fe,[s("a",De,[e.selectedUser.rank>0&&e.badge=="main"?w((o(),i("img",{key:e.$route.query.id,src:`/images/rank${e.selectedUser.rank}.png`,class:"osu-badge badge-small"},null,8,Be)),[[_,`${e.selectedUser.username}'s current MG rank`]]):l("",!0)]),s("a",Ne,[e.selectedUser.rank<5&&e.badge=="main"?w((o(),i("img",{key:e.$route.query.id,src:`/images/rank${e.selectedUser.rank+1}.png`,class:"osu-badge badge-small"},null,8,Oe)),[[_,`${e.selectedUser.username}'s next MG rank`]]):l("",!0)]),s("a",Ge,[e.badge=="mission"?w((o(),i("img",{key:e.$route.query.id,src:"/images/questbadge.png",class:"osu-badge badge-small"},null,8,Ve)),[[_,"quest trailblazer"]]):l("",!0)])]),s("div",Ee,[e.badge=="main"?(o(),i(y,{key:0},[h(d,{points:e.selectedUser.easyPoints,"bg-class":"bg-easy","tooltip-text":"mapping Easy difficulties","display-text":"Easy"},null,8,["points"]),h(d,{points:e.selectedUser.normalPoints,"bg-class":"bg-normal","tooltip-text":"mapping Normal difficulties","display-text":"Normal"},null,8,["points"]),h(d,{points:e.selectedUser.hardPoints,"bg-class":"bg-hard","tooltip-text":"mapping Hard difficulties","display-text":"Hard"},null,8,["points"]),h(d,{points:e.selectedUser.insanePoints,"bg-class":"bg-insane","tooltip-text":"mapping Insane difficulties","display-text":"Insane"},null,8,["points"]),h(d,{points:e.selectedUser.expertPoints,"bg-class":"bg-expert","tooltip-text":"mapping Expert difficulties","display-text":"Expert"},null,8,["points"]),h(d,{points:e.selectedUser.hitsoundPoints,"bg-class":"bg-rank-0","tooltip-text":"Hitsounding","display-text":"HS"},null,8,["points"]),h(d,{points:e.selectedUser.storyboardPoints,"bg-class":"bg-rank-4","tooltip-text":"Storyboarding","display-text":"SB"},null,8,["points"]),h(d,{points:e.selectedUser.questPoints,"bg-class":"bg-wip","tooltip-text":"Completing quests","display-text":"Quests"},null,8,["points"]),h(d,{points:e.selectedUser.missionPoints,"bg-class":"bg-qualified","tooltip-text":"Completing priority quests","display-text":"Priority quests"},null,8,["points"]),h(d,{points:e.selectedUser.modPoints,"bg-class":"bg-done","tooltip-text":"Modding","display-text":"Mods"},null,8,["points"]),h(d,{points:e.selectedUser.hostPoints,"bg-class":"bg-ranked","tooltip-text":"Hosting mapsets","display-text":"Host"},null,8,["points"]),h(d,{points:e.selectedUser.contestCreatorPoints+e.selectedUser.contestParticipantPoints+e.selectedUser.contestScreenerPoints+e.selectedUser.contestJudgePoints,"bg-class":"bg-open","tooltip-text":"Anything related to FA mapping contests ","display-text":"Contests"},null,8,["points"]),h(d,{points:e.selectedUser.legacyPoints,"bg-class":"bg-blocked","tooltip-text":"Legacy","display-text":"Legacy"},null,8,["points"]),h(d,{points:e.maxPoints-e.selectedUser.totalPoints,"bg-class":"bg-black","tooltip-text":"Points until next badge","display-text":"..."},null,8,["points","display-text"])],64)):e.badge=="mission"?(o(),i(y,{key:1},[(o(!0),i(y,null,v(e.selectedUser.completedMissions,(c,k)=>(o(),p(d,{key:k,points:1,"bg-class":e.bgOptions[k],"tooltip-text":c.name,"display-text":c.name,badge:"mission"},null,8,["bg-class","tooltip-text","display-text"]))),128)),h(d,{points:2,"bg-class":"bg-black","display-text":"...",badge:"mission"},null,8,["display-text"])],64)):l("",!0)])],64)}const He=C(Qe,[["render",Le],["__scopeId","data-v-41abaf5f"]]),je=S({name:"UserInfo",components:{UserPointsRow:Ae,ModalDialog:j,ModesIcons:E,RewardProgress:He},data(){return{currentQuests:[],currentMissions:[],createdQuestNames:[],spentPoints:[],userBeatmaps:[],sortOrder:Object.values(L)}},computed:{...A(["loggedInUser"]),...Q("users",["selectedUser"]),userCoverUrl(){var e;return this.selectedUser?this.selectedUser.cover?(e=this.selectedUser.cover)==null?void 0:e.url:`https://a.ppy.sh/${this.selectedUser.osuId}`:""},userRankColor(){return this.selectedUser?`var(--rank-${this.selectedUser.rank}-bg)`:"var(--rank-0-bg)"}},watch:{async selectedUser(){await this.loadEverything()}},async created(){await this.loadEverything()},methods:{async loadEverything(){if(!this.selectedUser)return;this.$router.push(`/users?id=${this.selectedUser.id}`),this.currentQuests=[],this.currentMissions=[],this.createdQuestNames=[],this.spentPoints=[],this.userBeatmaps=[];const[e,t,n,a,f]=await Promise.all([this.$http.executeGet(`/users/${this.selectedUser.id}/quests`),this.$http.executeGet(`/users/${this.selectedUser.id}/missions`),this.$http.executeGet(`/users/findCreatedQuests/${this.selectedUser.id}`),this.$http.executeGet(`/users/findSpentPoints/${this.selectedUser.id}`),this.$http.executeGet(`/users/findUserBeatmaps/${this.selectedUser.id}`)]);if(this.$http.isError(e)||(this.currentQuests=e),this.$http.isError(t)||(this.currentMissions=t),this.$http.isError(n)||(this.createdQuestNames=n),this.$http.isError(a)||(this.spentPoints=a),!this.$http.isError(f)){const g=["WIP","Done","Qualified","Ranked"];this.userBeatmaps=f.sort(function(d,_){return g.indexOf(d.status)-g.indexOf(_.status)})}},findIcon(e){return e==T.WIP?"fa-ellipsis-h":e==T.Done?"fa-check":e==T.Qualified||e==T.Ranked?"fa-check-circle":""},userTasks(e){[...e.tasks].sort((a,f)=>this.sortOrder.indexOf(a.name)-this.sortOrder.indexOf(f.name));let n="";return e.tasks.forEach(a=>{a.mappers.forEach(f=>{if(f.id==this.selectedUser.id){const g=a.mode=="taiko"?this.findTaikoName(a.name):a.mode=="catch"?this.findCatchName(a.name):a.name;n+=g+", "}})}),n.slice(0,-2)},findTaikoName(e){switch(e.toLowerCase()){case"easy":return"Kantan";case"normal":return"Futsuu";case"hard":return"Muzukashii";case"insane":return"Oni";case"expert":return"Inner Oni";default:return e}},findCatchName(e){switch(e.toLowerCase()){case"easy":return"Cup";case"normal":return"Salad";case"hard":return"Platter";case"insane":return"Rain";case"expert":return"Overdose";default:return e}},calculatePoints(e){let t=25;return e.art||(t+=10),e.requiredMapsets<1?t=727:e.requiredMapsets==1?t+=100:e.requiredMapsets<10&&(t+=(10-e.requiredMapsets)*7.5),t},findSpentPointsAction(e){switch(e){case U.AcceptQuest:return"Accepted quest:";case U.ReopenQuest:return"Reopened quest:";case U.ExtendDeadline:return"Extended quest deadline:";case U.CreateQuest:return"Created quest:";case U.RerollShowcaseMissionSong:return"Rerolled priority quest song:";case U.RerollShowcaseMissionArtist:return"Rerolled priority quest artist:";default:return"undefined action"}},findSpentPointsValue(e,t,n,a){switch(e){case U.AcceptQuest:return t.price;case U.ReopenQuest:return t.reopenPrice;case U.ExtendDeadline:return 10;case U.CreateQuest:return this.calculatePoints(t);case U.RerollShowcaseMissionSong:return 35;case U.RerollShowcaseMissionArtist:return this.calculateArtistRerollCost(n,a);default:return 0}},calculateArtistRerollCost(e,t){if(!e)return 10;const f=this.spentPoints.filter(g=>{var d;return g.category===U.RerollShowcaseMissionArtist&&((d=g.mission)==null?void 0:d.id)===e.id}).sort((g,d)=>new Date(g.createdAt).getTime()-new Date(d.createdAt).getTime()).findIndex(g=>g.id===t);return 10*Math.pow(2,f)}}});const m=e=>(F("data-v-89147f7c"),e=e(),D(),e),ze={class:"d-flex flex-row align-items-center gap-3"},Je=["src"],We=m(()=>s("div",{class:"radial-divisor"},null,-1)),Ke={class:"row"},Ye={class:"col-md-6"},Ze={class:"table table-sm small"},Xe=m(()=>s("thead",null,[s("tr",null,[s("th",{scope:"col"}," Task "),s("th",{scope:"col"}," Points ")])],-1)),xe=m(()=>s("td",{scope:"row"}," Total points earned ",-1)),es={scope:"row"},ss=m(()=>s("td",{scope:"row"}," Available points ",-1)),ts={scope:"row"},os=m(()=>s("i",{class:"fas fa-coins"},null,-1)),is={class:"col-md-6"},rs={class:"small"},ns={key:1,class:"text-secondary"},as={key:0,class:"small"},ls={class:"p-0 mb-2 ms-4"},ds=["href"],cs={key:1,class:"small"},us={class:"p-0 mb-2 ms-4"},ps=["href"],hs=m(()=>s("div",{class:"small"}," Completed priority quests: ",-1)),ms={class:"p-0 mb-2 ms-4"},gs=["href"],fs=m(()=>s("div",{class:"small"}," Completed quests: ",-1)),ys={class:"p-0 mb-2 ms-4"},_s=["href"],bs={key:4,class:"small"},ks={class:"p-0 mb-2 ms-4"},$s=m(()=>s("div",{class:"radial-divisor"},null,-1)),Us={class:"row"},Ps={class:"col-sm"},vs=m(()=>s("p",null,"Mappers' Guild beatmaps:",-1)),ws={class:"table table-sm"},Ms=m(()=>s("thead",null,[s("tr",null,[s("th",{scope:"col"}," Mapset "),s("th",{scope:"col"}," Host "),s("th",{scope:"col"}," Tasks "),s("th",{scope:"col"})])],-1)),Ss={key:0},Cs=m(()=>s("td",{scope:"row"}," ... ",-1)),As=m(()=>s("td",{scope:"row"}," ... ",-1)),qs=m(()=>s("td",{scope:"row"}," ... ",-1)),Is=m(()=>s("td",{scope:"row"},null,-1)),Rs=[Cs,As,qs,Is],Ts={scope:"row"},Qs=["href"],Fs={scope:"row"},Ds={scope:"row",class:"text-secondary"},Bs={scope:"row",class:"text-secondary"},Ns=["href"],Os=m(()=>s("i",{class:"fas fa-link"},null,-1)),Gs=[Os],Vs=m(()=>s("div",{class:"radial-divisor"},null,-1)),Es={class:"row"},Ls={class:"col-sm"},Hs=m(()=>s("p",null,"Spent points logs:",-1)),js={class:"table table-sm"},zs=m(()=>s("thead",null,[s("tr",null,[s("th",{scope:"col"}," Action "),s("th",{scope:"col"}," Spent points ")])],-1)),Js={key:0},Ws=m(()=>s("td",{scope:"row"}," ... ",-1)),Ks=m(()=>s("td",{scope:"row"}," ... ",-1)),Ys=[Ws,Ks],Zs={scope:"row",class:"text-secondary"},Xs=["href"],xs=["href"],et={scope:"row",class:"text-secondary"},st=m(()=>s("i",{class:"fas fa-coins"},null,-1)),tt=m(()=>s("div",{class:"radial-divisor"},null,-1)),ot={class:"float-end"};function it(e,t,n,a,f,g){const d=P("user-link"),_=P("reward-progress"),c=P("user-points-row"),k=P("modes-icons"),I=P("modal-dialog"),$=q("bs-tooltip");return o(),p(I,{id:"extendedInfo",loaded:!!e.selectedUser,"header-style":{background:`linear-gradient(0deg, ${e.userRankColor} -250%, rgba(0, 0, 0, 0.65) 130%), url(${e.userCoverUrl}) center no-repeat`,borderBottom:`4px solid ${e.userRankColor}`,backgroundSize:"cover",objectFit:"fill"}},{header:R(()=>[s("div",ze,[s("img",{src:"https://a.ppy.sh/"+e.selectedUser.osuId,class:"avatar-img"},null,8,Je),h(d,{class:"text-white ml-3",user:e.selectedUser},null,8,["user"])])]),default:R(()=>{var B;return[h(_,{badge:"main"}),e.selectedUser.completedMissions&&e.selectedUser.completedMissions.length?(o(),p(_,{key:0,badge:"mission"})):l("",!0),We,s("div",Ke,[s("div",Ye,[s("table",Ze,[Xe,s("tbody",null,[e.selectedUser.easyPoints?(o(),p(c,{key:0,points:e.selectedUser.easyPoints,display:"mapping Easy difficulties","tooltip-title":"~5 points per difficulty. +2 if quest mapset"},null,8,["points","tooltip-title"])):l("",!0),e.selectedUser.normalPoints?(o(),p(c,{key:1,points:e.selectedUser.normalPoints,display:"mapping Normal difficulties","tooltip-title":"~6 points per difficulty. +2 if quest mapset"},null,8,["points","tooltip-title"])):l("",!0),e.selectedUser.hardPoints?(o(),p(c,{key:2,points:e.selectedUser.hardPoints,display:"mapping Hard difficulties","tooltip-title":"~7 points per difficulty. +2 if quest mapset"},null,8,["points","tooltip-title"])):l("",!0),e.selectedUser.insanePoints?(o(),p(c,{key:3,points:e.selectedUser.insanePoints,display:"mapping Insane difficulties","tooltip-title":"~8 points per difficulty. +2 if quest mapset"},null,8,["points","tooltip-title"])):l("",!0),e.selectedUser.expertPoints?(o(),p(c,{key:4,points:e.selectedUser.expertPoints,display:"mapping Expert difficulties","tooltip-title":"~8 points per difficulty. +2 if quest mapset"},null,8,["points","tooltip-title"])):l("",!0),e.selectedUser.hitsoundPoints?(o(),p(c,{key:5,points:e.selectedUser.hitsoundPoints,display:"hitsounding","tooltip-title":"~2 points per mapset"},null,8,["points"])):l("",!0),e.selectedUser.storyboardPoints?(o(),p(c,{key:6,points:e.selectedUser.storyboardPoints,display:"creating storyboards","tooltip-title":"10 points per storyboard"},null,8,["points"])):l("",!0),e.selectedUser.questPoints?(o(),p(c,{key:7,points:e.selectedUser.questPoints,display:"completing quests","tooltip-title":"7 bonus points for completing quests on time"},null,8,["points"])):l("",!0),e.selectedUser.missionPoints?(o(),p(c,{key:8,points:e.selectedUser.missionPoints,display:"completing priority quests","tooltip-title":"5-24 bonus points for completing priority quests"},null,8,["points"])):l("",!0),e.selectedUser.modPoints?(o(),p(c,{key:9,points:e.selectedUser.modPoints,display:"modding mapsets","tooltip-title":"~1 point per mod"},null,8,["points"])):l("",!0),e.selectedUser.hostPoints?(o(),p(c,{key:10,points:e.selectedUser.hostPoints,display:"hosting mapsets","tooltip-title":"3 points per mapset hosted"},null,8,["points"])):l("",!0),e.selectedUser.contestCreatorPoints?(o(),p(c,{key:11,points:e.selectedUser.contestCreatorPoints,display:"FA contest creation","tooltip-title":"creation of FA beatmapping contests hosted on Mappers' Guild"},null,8,["points"])):l("",!0),e.selectedUser.contestParticipantPoints?(o(),p(c,{key:12,points:e.selectedUser.contestParticipantPoints,display:"FA contest participation","tooltip-title":"participating in FA beatmapping contests hosted on Mappers' Guild"},null,8,["points"])):l("",!0),e.selectedUser.contestScreenerPoints?(o(),p(c,{key:13,points:e.selectedUser.contestScreenerPoints,display:"FA contest screening","tooltip-title":"screening entries in FA beatmapping contests hosted on Mappers' Guild"},null,8,["points"])):l("",!0),e.selectedUser.contestJudgePoints?(o(),p(c,{key:14,points:e.selectedUser.contestJudgePoints,display:"FA contest judging","tooltip-title":"judging entries in FA beatmapping contests hosted on Mappers' Guild"},null,8,["points"])):l("",!0),e.selectedUser.legacyPoints?(o(),p(c,{key:15,points:e.selectedUser.legacyPoints,display:"legacy","tooltip-title":"points for things that are no longer applicable to Mappers' Guild"},null,8,["points"])):l("",!0),e.selectedUser.osuPoints?(o(),p(c,{key:16,points:e.selectedUser.osuPoints,display:"Total osu! points","tooltip-title":"mapping osu! game mode"},null,8,["points"])):l("",!0),e.selectedUser.taikoPoints?(o(),p(c,{key:17,points:e.selectedUser.taikoPoints,display:"Total osu!taiko points","tooltip-title":"mapping osu!taiko game mode"},null,8,["points"])):l("",!0),e.selectedUser.catchPoints?(o(),p(c,{key:18,points:e.selectedUser.catchPoints,display:"Total osu!catch points","tooltip-title":"mapping osu!catch game mode"},null,8,["points"])):l("",!0),e.selectedUser.maniaPoints?(o(),p(c,{key:19,points:e.selectedUser.maniaPoints,display:"Total osu!mania points","tooltip-title":"mapping osu!mania game mode"},null,8,["points"])):l("",!0),s("tr",null,[xe,s("td",es,u(e.selectedUser.totalPoints),1)]),s("tr",null,[ss,s("td",ts,[b(u(e.selectedUser.availablePoints)+" ",1),os])])])])]),s("div",is,[s("p",rs,[b(" Rank: "),e.selectedUser.rank>0?w((o(),i("i",{key:(B=e.$route.query.id)==null?void 0:B.toString(),class:M(["fas fa-crown","text-rank-"+e.selectedUser.rank])},null,2)),[[$,`rank ${e.selectedUser.rank} user`]]):(o(),i("span",ns," None "))]),e.currentMissions.length?(o(),i("div",as," Current missions: ")):l("",!0),s("ul",ls,[(o(!0),i(y,null,v(e.currentMissions,r=>(o(),i("li",{key:r.id,class:"small text-secondary"},[s("a",{href:"/missions?id="+r.id,target:"_blank"},u(r.name.length>40?r.name.slice(0,40)+"...":r.name),9,ds)]))),128))]),e.currentQuests.length?(o(),i("div",cs," Current quests: ")):l("",!0),s("ul",us,[(o(!0),i(y,null,v(e.currentQuests,r=>(o(),i("li",{key:r.id,class:"small text-secondary"},[s("a",{href:"/quests?id="+r.id,target:"_blank"},u(r.name.length>40?r.name.slice(0,40)+"...":r.name),9,ps)]))),128))]),e.selectedUser.completedMissions&&e.selectedUser.completedMissions.length?(o(),i(y,{key:2},[hs,s("ul",ms,[(o(!0),i(y,null,v(e.selectedUser.completedMissions,r=>(o(),i("li",{key:r.id,class:"small text-secondary"},[s("a",{href:"/missions?id="+r.id,target:"_blank"},u(r.name.length>40?r.name.slice(0,40)+"...":r.name),9,gs)]))),128))])],64)):l("",!0),e.selectedUser.completedQuests&&e.selectedUser.completedQuests.length?(o(),i(y,{key:3},[fs,s("ul",ys,[(o(!0),i(y,null,v(e.selectedUser.completedQuests,r=>(o(),i("li",{key:r.id,class:"small text-secondary"},[s("a",{href:"/quests?id="+r.id,target:"_blank"},u(r.name.length>40?r.name.slice(0,40)+"...":r.name),9,_s)]))),128))])],64)):l("",!0),e.createdQuestNames.length?(o(),i("div",bs," Created quests: ")):l("",!0),s("ul",ks,[(o(!0),i(y,null,v(e.createdQuestNames,r=>(o(),i("li",{key:r,class:"small text-secondary"},u(r.length>40?r.slice(0,40)+"...":r),1))),128))])])]),$s,s("div",Us,[s("div",Ps,[vs,s("table",ws,[Ms,s("tbody",null,[e.userBeatmaps.length?l("",!0):(o(),i("tr",Ss,Rs)),(o(!0),i(y,null,v(e.userBeatmaps,r=>(o(),i("tr",{key:r.id},[s("td",Ts,[w(s("i",{class:M(["fas me-1",["text-"+r.status.toLowerCase(),e.findIcon(r.status)]])},null,2),[[$,r.status]]),s("a",{href:"/beatmaps?id="+r.id,target:"_blank",class:"me-1"},u(r.song.artist)+" - "+u(r.song.title),9,Qs),r.mode!=="osu"?(o(),p(k,{key:0,modes:[r.mode],color:"secondary"},null,8,["modes"])):l("",!0)]),s("td",Fs,[h(d,{user:r.host},null,8,["user"])]),s("td",Ds,u(e.userTasks(r)),1),s("td",Bs,[r.url?(o(),i("a",{key:0,href:r.url,target:"_blank"},Gs,8,Ns)):l("",!0)])]))),128))])])])]),Vs,s("div",Es,[s("div",Ls,[Hs,s("table",js,[zs,s("tbody",null,[e.spentPoints.length?l("",!0):(o(),i("tr",Js,Ys)),(o(!0),i(y,null,v(e.spentPoints,r=>(o(),i("tr",{key:r.id},[s("td",Zs,[b(u(e.findSpentPointsAction(r.category))+" ",1),r.quest?(o(),i("a",{key:0,href:"/quests/?id="+r.quest.id,target:"_blank"},u(r.quest.name),9,Xs)):r.mission?(o(),i("a",{key:1,href:"/missions/?id="+r.mission.id,target:"_blank"},u(r.mission.name),9,xs)):l("",!0)]),s("td",et,[b(u(e.findSpentPointsValue(r.category,r.quest,r.mission,r.id))+" ",1),st])]))),128))])])])]),tt,s("p",ot," Joined: "+u(e.selectedUser.createdAt.slice(0,10)),1)]}),_:1},8,["loaded","header-style"])}const rt=C(je,[["render",it],["__scopeId","data-v-89147f7c"]]),nt=S({name:"UserPageFilters",components:{FilterBox:z,ModeFilters:J},data(){return{sorted:!1,sortOptions:{username:"Name",rank:"Rank",createdAt:"Joined"},displayOptions:{list:"List",cards:"Cards"}}},computed:A("users",["sortBy","displayAs","filterMode","filterValue"]),methods:{...H("users",["updateDisplay","updateSorting","updateFilterValue","updateFilterMode"])}}),at={class:"card card-body mb-2"},lt={class:"container"},dt={class:"row small mt-3"},ct=s("div",{class:"col-auto filter-title"}," Sort ",-1),ut={class:"col"},pt=["onClick"],ht={class:"row small mt-3"},mt=s("div",{class:"col-auto filter-title"}," Display ",-1),gt={class:"col"},ft=["onClick"];function yt(e,t,n,a,f,g){const d=P("mode-filters"),_=P("filter-box");return o(),i("div",at,[s("div",lt,[h(_,{placeholder:"enter to search for username...","filter-value":e.filterValue,"onUpdate:filterValue":t[1]||(t[1]=c=>e.updateFilterValue(c))},{filters:R(()=>[h(d,{"filter-mode":e.filterMode,"onUpdate:filterMode":t[0]||(t[0]=c=>e.updateFilterMode(c))},null,8,["filter-mode"])]),_:1},8,["filter-value"]),s("div",dt,[ct,s("div",ut,[(o(!0),i(y,null,v(e.sortOptions,(c,k)=>(o(),i("a",{key:k,class:M(e.sortBy===k?"sorted":"unsorted"),href:"#",onClick:N(I=>e.updateSorting(k),["prevent"])},u(c),11,pt))),128))])]),s("div",ht,[mt,s("div",gt,[(o(!0),i(y,null,v(e.displayOptions,(c,k)=>(o(),i("a",{key:k,class:M(e.displayAs===k?"sorted":"unsorted"),href:"#",onClick:N(I=>e.updateDisplay(k),["prevent"])},u(c),11,ft))),128))])])])])}const _t=C(nt,[["render",yt]]),bt={namespaced:!0,state:{users:[],selectedUserId:null,filterValue:"",filterMode:G.any,sortBy:"rank",displayAs:"list",sortDesc:!0,pagination:{page:1,limit:16,maxPages:1}},mutations:{setUsers(e,t){e.users=t},addSpecificUser(e,t){e.users.push(t)},setFilterValue(e,t){e.filterValue=t},setFilterMode(e,t){e.filterMode=t},setSelectedUserId(e,t){e.selectedUserId=t},updateUser(e,t){const n=e.users.findIndex(a=>a.id===t.id);n!==-1&&(e.users[n]=t)},setSortBy(e,t){e.sortBy=t},setSortDesc(e,t){e.sortDesc=t},setDisplayAs(e,t){e.displayAs=t},increasePaginationPage(e){e.pagination.page+=1},decreasePaginationPage(e){e.pagination.page-=1},resetPaginationPage(e){e.pagination.page=1},updatePaginationMaxPages(e,t){e.pagination.maxPages=t}},getters:{filteredUsers:e=>{let t=[...e.users];if(e.filterMode!==G.any){const n=e.filterMode;t=t.filter(a=>!!(n=="osu"&&a.osuPoints||n=="taiko"&&a.taikoPoints||n=="catch"&&a.catchPoints||n=="mania"&&a.maniaPoints))}return e.filterValue.length>2&&(t=t.filter(n=>n.username.toLowerCase().includes(e.filterValue.toLowerCase()))),e.sortBy==="createdAt"?t.sort((n,a)=>+n.createdAt-+a.createdAt):e.sortBy==="username"?t.sort((n,a)=>a.username.toLowerCase().localeCompare(n.username.toLowerCase())):e.sortBy==="rank"&&(e.filterMode==="osu"?t.sort((n,a)=>n.osuPoints-a.osuPoints):e.filterMode==="taiko"?t.sort((n,a)=>n.taikoPoints-a.taikoPoints):e.filterMode==="catch"?t.sort((n,a)=>n.catchPoints-a.catchPoints):e.filterMode==="mania"?t.sort((n,a)=>n.maniaPoints-a.maniaPoints):t.sort((n,a)=>n.totalPoints-a.totalPoints)),e.sortDesc&&t.reverse(),t},paginatedUsers:(e,t)=>t.filteredUsers.slice(e.pagination.limit*(e.pagination.page-1),e.pagination.limit*e.pagination.page),selectedUser:e=>e.users.find(t=>t.id===e.selectedUserId),allUsers:e=>e.users},actions:{updateFilterMode({commit:e},t){e("resetPaginationPage"),e("setFilterMode",t)},updateFilterValue({commit:e},t){e("resetPaginationPage"),e("setFilterValue",t)},updatePaginationMaxPages({commit:e,getters:t,state:n}){const a=Math.ceil(t.filteredUsers.length/n.pagination.limit);e("updatePaginationMaxPages",a)},updateSorting({commit:e,state:t},n){t.sortBy!==n||t.sortDesc===!1?e("setSortDesc",!0):e("setSortDesc",!1),e("setSortBy",n)},updateDisplay({commit:e,state:t},n){t.displayAs!==n&&e("setDisplayAs",n)}}},kt=bt,$t=S({name:"UserPage",components:{UserCard:ae,UserInfo:rt,UserPageFilters:_t,UserListElement:Pe},data(){return{queriedAll:!1}},computed:{...A(["loggedInUser"]),...A("users",["pagination","displayAs"]),...Q("users",["paginatedUsers","allUsers","filteredUsers"])},watch:{paginatedUsers(){this.$store.dispatch("users/updatePaginationMaxPages")}},beforeCreate(){this.$store.hasModule("users")||this.$store.registerModule("users",kt)},async created(){const e=await this.$http.initialRequest("/users/queryRanked");if(!this.$http.isError(e)){this.$store.commit("users/setUsers",e.users);const t=this.$route.query.id;if(t){let n=this.allUsers.findIndex(a=>a.id==t);if(n<0){const a=await this.$http.executeGet(`/users/queryUser/${t}`);this.$store.commit("users/addSpecificUser",a),n=this.allUsers.findIndex(f=>f.id==t)}n>=0&&(this.$store.commit("users/setSelectedUserId",t),this.$bs.showModal("extendedInfo"))}}},methods:{showOlder(){this.$store.commit("users/increasePaginationPage")},showNewer(){this.$store.commit("users/decreasePaginationPage")},async showAll(e){const t=await this.$http.executeGet("/users/queryAll",e);this.$http.isError(t)||this.$store.commit("users/setUsers",t.users)}}}),Ut={key:0,class:"container card card-body py-3"},Pt=["disabled"],vt=s("i",{class:"fas fa-angle-up me-1"},null,-1),wt=s("i",{class:"fas fa-angle-up ms-1"},null,-1),Mt={class:"small text-center mx-auto"},St=["disabled"],Ct=s("i",{class:"fas fa-angle-down me-1"},null,-1),At=s("i",{class:"fas fa-angle-down ms-1"},null,-1),qt={key:1,class:"container card card-body py-3"},It=s("div",{class:"radial-divisor"},null,-1),Rt={class:"text-center mt-2"},Tt=s("i",{class:"fas fa-angle-down me-1"},null,-1),Qt=s("i",{class:"fas fa-angle-down ms-1"},null,-1);function Ft(e,t,n,a,f,g){const d=P("user-page-filters"),_=P("user-card"),c=P("user-list-element"),k=P("user-info"),I=q("bs-tooltip");return o(),i("div",null,[h(d),e.displayAs=="cards"?(o(),i("div",Ut,[s("button",{disabled:e.pagination.page==1,class:"btn btn-sm btn-primary mx-auto my-2 d-block",type:"button",onClick:t[0]||(t[0]=(...$)=>e.showNewer&&e.showNewer(...$))},[vt,b(" show newer "),wt],8,Pt),s("div",null,[h(O,{name:"list",tag:"div",class:"row px-3"},{default:R(()=>[(o(!0),i(y,null,v(e.paginatedUsers,$=>(o(),p(_,{key:$.id,user:$},null,8,["user"]))),128))]),_:1}),s("div",Mt,u(e.paginatedUsers.length===0?"0":e.pagination.page)+" of "+u(e.pagination.maxPages),1),s("button",{disabled:e.pagination.page>=e.pagination.maxPages,class:"btn btn-sm btn-primary mx-auto my-2 d-block",type:"button",onClick:t[1]||(t[1]=(...$)=>e.showOlder&&e.showOlder(...$))},[Ct,b(" show older "),At],8,St)])])):e.displayAs=="list"?(o(),i("div",qt,[h(O,{name:"list",tag:"div",class:"row px-3"},{default:R(()=>[e.loggedInUser?(o(),p(c,{key:e.loggedInUser.id,user:e.loggedInUser},null,8,["user"])):l("",!0),It,(o(!0),i(y,null,v(e.filteredUsers,$=>(o(),p(c,{key:$.id,user:$},null,8,["user"]))),128))]),_:1}),s("div",Rt,[w((o(),i("button",{class:"btn btn-sm btn-primary",type:"button",onClick:t[2]||(t[2]=$=>e.showAll($))},[Tt,b(" show all users "),Qt])),[[I,"this will take a couple seconds..."]])])])):l("",!0),h(k)])}const Gt=C($t,[["render",Ft]]);export{Gt as default};

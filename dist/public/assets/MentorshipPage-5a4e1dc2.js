import{d as w,m as k,A as E,_ as D,o as l,e as a,a as s,F as I,r as M,i as d,z as p,b as f,f as $,g as T,q as _,v as N,t as h,U as L,j as C,k as g,n as U,s as K,u as V,x as B}from"./index-537935a7.js";import{m as P,A as R}from"./AddUserManually-7ecac3a0.js";const G=w({name:"Administrators",components:{},data(){return{userInput:null,confirmDelete:null}},computed:{...k(["loggedInUser"]),...E("mentorship",["allAdmins"])},beforeCreate(){this.$store.hasModule("mentorship")||this.$store.registerModule("mentorship",P)},methods:{async toggleIsMentorshipAdmin(e,t){const o=await this.$http.executePost("/mentorship/toggleIsMentorshipAdmin",{userInput:this.userInput,userId:t},e);if(!this.$http.isError(o))if(this.$store.dispatch("updateToastMessages",{message:`${o.isMentorshipAdmin?"Added":"Removed"}`,type:"info"}),o.isMentorshipAdmin){const i=[...this.allAdmins];i.push(o),this.$store.commit("mentorship/setAdmins",i)}else this.$store.commit("mentorship/removeAdmin",t)}}}),j={class:"container card card-body py-3"},z=s("h5",null,"Mentorship Administrators",-1),F=s("div",{class:"text-secondary"}," Users with access to mentorship tools: ",-1),q=["onClick"],H=["onClick"],J={class:"input-group w-25"},O={class:"input-group-append"},Q=s("i",{class:"fas fa-plus fa-xs"},null,-1),W=[Q];function X(e,t,o,i,m,y){const r=_("user-link");return l(),a("div",null,[s("div",j,[z,F,s("ul",null,[(l(!0),a(I,null,M(e.allAdmins,n=>(l(),a("li",{key:n.id},[d(r,{user:n},null,8,["user"]),e.confirmDelete!=n.id?(l(),a("a",{key:0,href:"#",class:"text-danger",onClick:p(v=>e.confirmDelete=n.id,["prevent"])}," delete ",8,q)):(l(),a("a",{key:1,class:"text-danger",href:"#",onClick:p(v=>e.toggleIsMentorshipAdmin(v,n.id),["prevent"])}," confirm ",8,H))]))),128))]),s("div",J,[f(s("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>e.userInput=n),class:"form-control form-control-sm",autocomplete:"off",placeholder:"new admin username/osuId...",onKeyup:t[1]||(t[1]=T(n=>e.toggleIsMentorshipAdmin(n,null),["enter"]))},null,544),[[$,e.userInput,void 0,{number:!0}]]),s("div",O,[s("button",{class:"btn btn-primary",href:"#",onClick:t[2]||(t[2]=p(n=>e.toggleIsMentorshipAdmin(n,null),["prevent"]))},W)])])])])}const Y=D(G,[["render",X]]),Z=w({name:"Cycles",data(){return{cycleNumberInput:null,cycleNameInput:null,cycleUrlInput:null,cycleStartInput:null,cycleEndInput:null,duplicateCycleId:""}},computed:{...k(["loggedInUser"]),...E("mentorship",["allCycles"])},beforeCreate(){this.$store.hasModule("mentorship")||this.$store.registerModule("mentorship",P)},methods:{async addCycle(e){if(confirm("Are you sure? Details cannot be changed after adding.")){const o=await this.$http.executePost("/mentorship/addCycle",{number:this.cycleNumberInput,name:this.cycleNameInput,url:this.cycleUrlInput,startDate:this.cycleStartInput,endDate:this.cycleEndInput,duplicateCycleId:this.duplicateCycleId},e);if(!this.$http.isError(o)){this.$store.dispatch("updateToastMessages",{message:`Added "${o.number} - ${o.name}"`,type:"info"});const i=[...this.allCycles];i.unshift(o),this.$store.commit("mentorship/setCycles",i)}}}}}),x={class:"container card card-body py-3 mb-2"},ee=s("h5",null,"New cycle",-1),te=s("div",{class:"text-secondary"}," Add a new cycle based on input below. ",-1),se=s("div",{class:"text-secondary"}," To copy relationships from an existing cycle, select the cycle in the dropdown. ",-1),oe={class:"row"},ne={class:"col-sm-6 mb-2"},re=s("option",{value:"",selected:"",disabled:""}," Select a cycle to duplicate ",-1),ie=["value"],le={class:"input-group mt-2"},ae={class:"input-group-append"},de=s("i",{class:"fas fa-plus fa-xs"},null,-1),ce=[de];function ue(e,t,o,i,m,y){return l(),a("div",null,[s("div",x,[ee,te,se,s("div",oe,[s("div",ne,[f(s("select",{"onUpdate:modelValue":t[0]||(t[0]=r=>e.duplicateCycleId=r),class:"form-select form-select d-inline"},[re,(l(!0),a(I,null,M(e.allCycles,r=>(l(),a("option",{key:r.id,value:r.id},h(r.number)+" - "+h(r.name),9,ie))),128))],512),[[N,e.duplicateCycleId]])])]),s("div",le,[f(s("input",{"onUpdate:modelValue":t[1]||(t[1]=r=>e.cycleNumberInput=r),class:"form-control form-control-sm",autocomplete:"off",type:"number",placeholder:"new cycle number..."},null,512),[[$,e.cycleNumberInput,void 0,{number:!0}]]),f(s("input",{"onUpdate:modelValue":t[2]||(t[2]=r=>e.cycleNameInput=r),class:"form-control form-control-sm",autocomplete:"off",placeholder:"new cycle name..."},null,512),[[$,e.cycleNameInput,void 0,{number:!0}]]),f(s("input",{"onUpdate:modelValue":t[3]||(t[3]=r=>e.cycleUrlInput=r),class:"form-control form-control-sm",autocomplete:"off",placeholder:"cycle details link..."},null,512),[[$,e.cycleUrlInput,void 0,{number:!0}]]),f(s("input",{"onUpdate:modelValue":t[4]||(t[4]=r=>e.cycleStartInput=r),class:"form-control form-control-sm",type:"date"},null,512),[[$,e.cycleStartInput]]),f(s("input",{"onUpdate:modelValue":t[5]||(t[5]=r=>e.cycleEndInput=r),class:"form-control form-control-sm",type:"date"},null,512),[[$,e.cycleEndInput]]),s("div",ae,[s("button",{class:"btn btn-primary",href:"#",onClick:t[6]||(t[6]=p(r=>e.addCycle(r),["prevent"]))},ce)])])])])}const pe=D(Z,[["render",ue]]),me=w({name:"ParticipantList",components:{UserLinkList:L},props:{mode:{type:String,default:""}},data(){return{mentorInput:null,menteeInput:null,extraMentorInput:null,editingMentorId:"",confirmDeleteMentor:"",confirmDeleteMentee:"",phaseEdit:!1}},computed:{...k(["loggedInUser"]),...k("mentorship",["showPhases"]),...E("mentorship",["selectedCycle"]),modeMentors(){return this.selectedCycle.participants.filter(t=>{for(const o of t.mentorships)if(o.mode==this.mode&&o.group=="mentor"&&o.cycle.toString()==this.selectedCycle.id)return!0}).sort((t,o)=>t.username.toLowerCase()>o.username.toLowerCase()?1:o.username.toLowerCase()>t.username.toLowerCase()?-1:0)},modeMentees(){return this.selectedCycle.participants.filter(t=>{for(const o of t.mentorships)if(o.mode==this.mode&&o.group=="mentee"&&o.cycle.toString()==this.selectedCycle.id)return!0}).sort((t,o)=>t.username.toLowerCase()>o.username.toLowerCase()?1:o.username.toLowerCase()>t.username.toLowerCase()?-1:0)},modeExtraMentors(){return this.selectedCycle.participants.filter(t=>{for(const o of t.mentorships)if(o.mode==this.mode&&o.group=="extraMentor"&&o.cycle.toString()==this.selectedCycle.id)return!0})},title(){return this.mode=="modding"||this.mode=="graduation"||this.mode=="storyboard"?this.mode:this.mode=="osu"?"osu!":"osu!"+this.mode}},beforeCreate(){this.$store.hasModule("mentorship")||this.$store.registerModule("mentorship",P)},methods:{findMentees(e){return this.modeMentees.filter(o=>{for(const i of o.mentorships)if(i.group=="mentee"&&i.mentor.toString()==e&&i.cycle.toString()==this.selectedCycle.id)return!0})},findExtraMentors(e){return this.modeExtraMentors.filter(o=>{for(const i of o.mentorships)if(i.group=="extraMentor"&&i.mentor.toString()==e&&i.cycle.toString()==this.selectedCycle.id)return!0})},findCombinedMentors(e){const t=this.findExtraMentors(e.id);return t&&t.length?[e].concat(t):[e]},isPhaseParticipant(e,t,o){const i=e.mentorships.find(m=>m.cycle.toString()==this.selectedCycle.id&&m.mode==this.mode&&(m.mentor?m.mentor.toString()==o:o==e.id));return!!(i&&i.phases.includes(t))},involvedInAllPhases(e){return e.mentorships.find(o=>o.cycle.toString()==this.selectedCycle.id&&o.mode==this.mode).phases.length==3},async addMentor(e,t){const o=await this.$http.executePost("/mentorship/addMentor",{cycleId:this.selectedCycle.id,userInput:t?this.extraMentorInput:this.mentorInput,mode:this.mode,mainMentorId:t},e);this.$http.isError(o)||(this.$store.dispatch("updateToastMessages",{message:`Added "${t?this.extraMentorInput:this.mentorInput}"`,type:"info"}),this.$store.commit("mentorship/updateCycle",o),this.mentorInput=null,this.extraMentorInput=null)},async addMentee(e,t){const o=await this.$http.executePost("/mentorship/addMentee",{cycleId:this.selectedCycle.id,userInput:this.menteeInput,mode:this.mode,mentorId:t},e);this.$http.isError(o)||(this.$store.dispatch("updateToastMessages",{message:`Added "${this.menteeInput}"`,type:"info"}),this.$store.commit("mentorship/updateCycle",o),this.menteeInput=null,this.editingMentorId="")},async removeParticipant(e,t){const o=await this.$http.executePost("/mentorship/removeParticipant",{cycleId:this.selectedCycle.id,userId:t,mode:this.mode},e);this.$http.isError(o)||(this.$store.dispatch("updateToastMessages",{message:"Removed user",type:"info"}),this.$store.commit("mentorship/updateCycle",o),this.confirmDeleteMentee="",this.confirmDeleteMentor="")},async togglePhase(e,t,o){this.phaseEdit=!0;const i=await this.$http.executePost("/mentorship/togglePhase",{cycleId:this.selectedCycle.id,userId:e.id,mode:this.mode,phaseNum:t,mentorId:o});this.$http.isError(i)||(this.$store.dispatch("updateToastMessages",{message:`Toggled phase ${t} for ${e.username}`,type:"info"}),this.$store.commit("mentorship/updateCycle",i)),this.phaseEdit=!1}}});const S=e=>(V("data-v-7decbf5f"),e=e(),B(),e),he={class:"col-sm-3"},ye={key:0,class:"text-secondary"},fe=["onClick"],$e=S(()=>s("i",{class:"fas fa-plus"},null,-1)),ge=[$e],_e={key:1},ve=["onClick"],Ce=S(()=>s("i",{class:"fas fa-minus"},null,-1)),be=[Ce],Ie=["onClick"],Me={key:2,class:"small"},ke=["onClick"],we={key:3,class:"input-group mt-1"},De=["onKeyup"],Ue={class:"input-group-append"},Pe=["onClick"],Ee=S(()=>s("i",{class:"fas fa-plus fa-xs"},null,-1)),Se=[Ee],Te={key:0,class:"text-secondary"},Ae=["onClick"],Ne=S(()=>s("i",{class:"fas fa-minus"},null,-1)),Ve=[Ne],Be=["onClick"],Le={key:3,class:"small"},Ke=["onClick"],Re={key:4,class:"input-group"},Ge=["onKeyup"],je={class:"input-group-append"},ze=["onClick"],Fe=S(()=>s("i",{class:"fas fa-plus fa-xs"},null,-1)),qe=[Fe],He={class:"input-group mb-3"},Je={class:"input-group-append"},Oe=S(()=>s("i",{class:"fas fa-plus fa-xs"},null,-1)),Qe=[Oe];function We(e,t,o,i,m,y){const r=_("user-link-list"),n=_("user-link"),v=K("bs-tooltip");return l(),a("div",he,[s("h5",null,h(e.title),1),s("ol",null,[(l(!0),a(I,null,M(e.modeMentors,c=>(l(),a("li",{key:c.id+e.mode},[d(r,{users:e.findCombinedMentors(c)},null,8,["users"]),e.involvedInAllPhases(c)?g("",!0):f((l(),a("span",ye,[C("*")])),[[v,"skips phases"]]),s("a",{href:"#",class:"text-success ms-1 small",onClick:p(u=>e.editingMentorId=c.id,["prevent"])},ge,8,fe),e.findMentees(c.id).length?g("",!0):(l(),a("span",_e,[e.confirmDeleteMentor!=c.id?(l(),a("a",{key:0,href:"#",class:"text-danger ms-1 small",onClick:p(u=>e.confirmDeleteMentor=c.id,["prevent"])},be,8,ve)):(l(),a("a",{key:1,class:"text-danger",href:"#",onClick:p(u=>e.removeParticipant(u,e.findExtraMentors(c.id).length?e.findExtraMentors(c.id)[e.findExtraMentors(c.id).length-1].id:c.id),["prevent"])}," confirm ",8,Ie))])),e.showPhases?(l(),a("span",Me,[(l(),a(I,null,M(3,u=>s("a",{key:u,href:"#",class:U(e.phaseEdit?"fake-button-disable":""),onClick:p(b=>e.togglePhase(c,u,null),["prevent"])},[s("span",{class:U([e.isPhaseParticipant(c,u,c.id)?"":"text-danger","ms-1"])},"P"+h(u),3)],10,ke)),64))])):g("",!0),e.editingMentorId==c.id?(l(),a("div",we,[f(s("input",{"onUpdate:modelValue":t[0]||(t[0]=u=>e.extraMentorInput=u),class:"form-control form-control-sm ms-2 mb-1",autocomplete:"off",placeholder:"joint mentor username/osuId...",onKeyup:T(u=>e.addMentor(u,c.id),["enter"])},null,40,De),[[$,e.extraMentorInput]]),s("div",Ue,[s("button",{class:"btn btn-primary",href:"#",onClick:p(u=>e.addMentor(u,c.id),["prevent"])},Se,8,Pe)])])):g("",!0),s("ul",null,[(l(!0),a(I,null,M(e.findMentees(c.id),u=>(l(),a("li",{key:u.id+e.mode,class:"small"},[d(n,{user:u},null,8,["user"]),e.involvedInAllPhases(u)?g("",!0):f((l(),a("span",Te,[C("*")])),[[v,"skips phases"]]),e.confirmDeleteMentee!=u.id?(l(),a("a",{key:1,href:"#",class:"text-danger ms-1 small",onClick:p(b=>e.confirmDeleteMentee=u.id,["prevent"])},Ve,8,Ae)):(l(),a("a",{key:2,class:"text-danger",href:"#",onClick:p(b=>e.removeParticipant(b,u.id),["prevent"])}," confirm ",8,Be)),e.showPhases?(l(),a("span",Le,[(l(),a(I,null,M(3,b=>s("a",{key:b,href:"#",class:U(e.phaseEdit?"fake-button-disable":""),onClick:p(ks=>e.togglePhase(u,b,c.id),["prevent"])},[s("span",{class:U([e.isPhaseParticipant(u,b,c.id)?"":"text-danger","ms-1"])},"P"+h(b),3)],10,Ke)),64))])):g("",!0)]))),128))]),e.editingMentorId==c.id?(l(),a("div",Re,[f(s("input",{"onUpdate:modelValue":t[1]||(t[1]=u=>e.menteeInput=u),class:"form-control form-control-sm ms-2",autocomplete:"off",placeholder:"new mentee username/osuId...",onKeyup:T(u=>e.addMentee(u,c.id),["enter"])},null,40,Ge),[[$,e.menteeInput]]),s("div",je,[s("button",{class:"btn btn-primary",href:"#",onClick:p(u=>e.addMentee(u,c.id),["prevent"])},qe,8,ze)])])):g("",!0)]))),128))]),s("div",He,[f(s("input",{"onUpdate:modelValue":t[2]||(t[2]=c=>e.mentorInput=c),class:"form-control form-control-sm",autocomplete:"off",placeholder:"new mentor username/osuId...",onKeyup:t[3]||(t[3]=T(c=>e.addMentor(c,null),["enter"]))},null,544),[[$,e.mentorInput]]),s("div",Je,[s("button",{class:"btn btn-primary",href:"#",onClick:t[4]||(t[4]=p(c=>e.addMentor(c,null),["prevent"]))},Qe)])])])}const Xe=D(me,[["render",We],["__scopeId","data-v-7decbf5f"]]),Ye=w({name:"Participants",components:{ParticipantList:Xe},data(){return{cycleId:"",showCycleInputs:!1,cycleNameInput:null,cycleNumberInput:null,cycleUrlInput:null,cycleStartDateInput:new Date,cycleEndDateInput:new Date}},computed:{...k(["loggedInUser"]),...k("mentorship",["showPhases"]),...E("mentorship",["allCycles","selectedCycle"])},watch:{cycleId(){this.$store.commit("mentorship/setSelectedCycleId",this.cycleId),this.cycleNameInput=this.selectedCycle.name,this.cycleNumberInput=this.selectedCycle.number,this.cycleUrlInput=this.selectedCycle.url,this.cycleStartDateInput=new Date(this.selectedCycle.startDate),this.cycleEndDateInput=new Date(this.selectedCycle.endDate)}},beforeCreate(){this.$store.hasModule("mentorship")||this.$store.registerModule("mentorship",P)},methods:{toggleShowPhases(){this.$store.commit("mentorship/toggleShowPhases")},async updateCycleName(e){const t=await this.$http.executePost("/mentorship/updateCycleName",{cycleId:this.selectedCycle.id,name:this.cycleNameInput},e);this.$http.isError(t)||(this.$store.dispatch("updateToastMessages",{message:"Updated cycle name",type:"info"}),this.$store.commit("mentorship/updateCycle",t))},async updateCycleNumber(e){const t=await this.$http.executePost("/mentorship/updateCycleNumber",{cycleId:this.selectedCycle.id,number:this.cycleNumberInput},e);this.$http.isError(t)||(this.$store.dispatch("updateToastMessages",{message:"Updated cycle number",type:"info"}),this.$store.commit("mentorship/updateCycle",t))},async updateCycleUrl(e){const t=await this.$http.executePost("/mentorship/updateCycleUrl",{cycleId:this.selectedCycle.id,url:this.cycleUrlInput},e);this.$http.isError(t)||(this.$store.dispatch("updateToastMessages",{message:"Updated cycle url",type:"info"}),this.$store.commit("mentorship/updateCycle",t))},async updateCycleStartDate(e){const t=await this.$http.executePost("/mentorship/updateCycleStartDate",{cycleId:this.selectedCycle.id,startDate:this.cycleStartDateInput},e);this.$http.isError(t)||(this.$store.dispatch("updateToastMessages",{message:"Updated cycle start date",type:"info"}),this.$store.commit("mentorship/updateCycle",t))},async updateCycleEndDate(e){const t=await this.$http.executePost("/mentorship/updateCycleEndDate",{cycleId:this.selectedCycle.id,endDate:this.cycleEndDateInput},e);this.$http.isError(t)||(this.$store.dispatch("updateToastMessages",{message:"Updated cycle end date",type:"info"}),this.$store.commit("mentorship/updateCycle",t))}}}),Ze={class:"container card card-body py-3 mb-2"},xe={class:"row"},et={class:"col-sm-6 mb-2"},tt=s("option",{value:"",selected:"",disabled:""}," Select a cycle ",-1),st=["value"],ot={key:0},nt=s("hr",null,null,-1),rt={key:0,class:"mb-4"},it={class:"row"},lt=s("div",{class:"col-sm-2"}," Cycle name: ",-1),at={class:"col-sm-4 mb-2"},dt={class:"input-group"},ct={class:"input-group-append"},ut={class:"row"},pt=s("div",{class:"col-sm-2"}," Cycle number: ",-1),mt={class:"col-sm-4 mb-2"},ht={class:"input-group"},yt={class:"input-group-append"},ft={class:"row"},$t=s("div",{class:"col-sm-2"}," Cycle url: ",-1),gt={class:"col-sm-4 mb-2"},_t={class:"input-group"},vt={class:"input-group-append"},Ct={class:"row"},bt=s("div",{class:"col-sm-2"}," Cycle start date: ",-1),It={class:"col-sm-4 mb-2"},Mt={class:"input-group"},kt={class:"input-group-append"},wt={class:"row"},Dt=s("div",{class:"col-sm-2"}," Cycle end date: ",-1),Ut={class:"col-sm-4 mb-2"},Pt={class:"input-group"},Et={class:"input-group-append"},St={key:1},Tt={key:0,class:"fas fa-edit"},At={class:"text-secondary small"},Nt={class:"row"};function Vt(e,t,o,i,m,y){const r=_("participant-list");return l(),a("div",null,[s("div",Ze,[s("div",xe,[s("div",et,[f(s("select",{"onUpdate:modelValue":t[0]||(t[0]=n=>e.cycleId=n),class:"form-select form-select d-inline"},[tt,(l(!0),a(I,null,M(e.allCycles,n=>(l(),a("option",{key:n.id,value:n.id},h(n.number)+" - "+h(n.name),9,st))),128))],512),[[N,e.cycleId]])])]),e.selectedCycle?(l(),a("div",ot,[nt,e.showCycleInputs?(l(),a("div",rt,[s("div",it,[lt,s("div",at,[s("div",dt,[f(s("input",{"onUpdate:modelValue":t[1]||(t[1]=n=>e.cycleNameInput=n),class:"form-control form-control-sm",autocomplete:"off",placeholder:"cycle name..."},null,512),[[$,e.cycleNameInput]]),s("div",ct,[s("button",{class:"btn btn-primary",href:"#",onClick:t[2]||(t[2]=p(n=>e.updateCycleName(n),["prevent"]))}," save ")])])])]),s("div",ut,[pt,s("div",mt,[s("div",ht,[f(s("input",{"onUpdate:modelValue":t[3]||(t[3]=n=>e.cycleNumberInput=n),class:"form-control form-control-sm",autocomplete:"off",type:"number",placeholder:"cycle number..."},null,512),[[$,e.cycleNumberInput,void 0,{number:!0}]]),s("div",yt,[s("button",{class:"btn btn-primary",href:"#",onClick:t[4]||(t[4]=p(n=>e.updateCycleNumber(n),["prevent"]))}," save ")])])])]),s("div",ft,[$t,s("div",gt,[s("div",_t,[f(s("input",{"onUpdate:modelValue":t[5]||(t[5]=n=>e.cycleUrlInput=n),class:"form-control form-control-sm",autocomplete:"off",placeholder:"cycle url..."},null,512),[[$,e.cycleUrlInput]]),s("div",vt,[s("button",{class:"btn btn-primary",href:"#",onClick:t[6]||(t[6]=p(n=>e.updateCycleUrl(n),["prevent"]))}," save ")])])])]),s("div",Ct,[bt,s("div",It,[s("div",Mt,[f(s("input",{"onUpdate:modelValue":t[7]||(t[7]=n=>e.cycleStartDateInput=n),class:"form-control form-control-sm",type:"date",placeholder:"cycle start date..."},null,512),[[$,e.cycleStartDateInput]]),s("div",kt,[s("button",{class:"btn btn-primary",href:"#",onClick:t[8]||(t[8]=p(n=>e.updateCycleStartDate(n),["prevent"]))}," save ")])])])]),s("div",wt,[Dt,s("div",Ut,[s("div",Pt,[f(s("input",{"onUpdate:modelValue":t[9]||(t[9]=n=>e.cycleEndDateInput=n),class:"form-control form-control-sm",type:"date",placeholder:"cycle end date..."},null,512),[[$,e.cycleEndDateInput]]),s("div",Et,[s("button",{class:"btn btn-primary",href:"#",onClick:t[10]||(t[10]=p(n=>e.updateCycleEndDate(n),["prevent"]))}," save ")])])])]),s("a",{href:"#",onClick:t[11]||(t[11]=p(n=>e.showCycleInputs=!e.showCycleInputs,["prevent"]))}," stop editing (close without saving) ")])):(l(),a("h4",St,[C(h(e.selectedCycle.name)+" ",1),s("a",{href:"#",onClick:t[12]||(t[12]=p(n=>e.showCycleInputs=!e.showCycleInputs,["prevent"]))},[C(h(e.showCycleInputs?"close":"")+" ",1),e.showCycleInputs?g("",!0):(l(),a("i",Tt))])])),s("h5",At,h(e.selectedCycle.startDate.slice(0,10))+" - "+h(e.selectedCycle.endDate.slice(0,10)),1),s("button",{class:"btn btn-sm btn-outline-info mb-2",onClick:t[13]||(t[13]=n=>e.toggleShowPhases())},h(e.showPhases?"Hide":"Show")+" phases ",1),s("div",null,[s("div",Nt,[d(r,{mode:"osu"}),d(r,{mode:"taiko"}),d(r,{mode:"catch"}),d(r,{mode:"mania"}),d(r,{mode:"modding"}),d(r,{mode:"graduation"}),d(r,{mode:"storyboard"})])])])):g("",!0)])])}const Bt=D(Ye,[["render",Vt]]),Lt=w({name:"CycleList",props:{mode:{type:String,default:""},group:{type:String,default:""}},data(){return{extraMentees:[]}},computed:{...k("mentorship",["selectedUser"]),modeMentorships(){return this.selectedUser.mentorships?this.selectedUser.mentorships.filter(e=>{let t=e.group;if(t=="extraMentor"&&(t="mentor"),t==this.group&&e.mode==this.mode)return!0}):[]},mentorshipsToPhases(){if(this.modeMentorships.length){let e=0;for(const t of this.modeMentorships)t.phases.length&&(e+=t.phases.length/3);return Math.round(e*100)/100}return 0},modeDuration(){return this.calculateDuration(this.modeMentorships)},title(){return this.mode=="modding"||this.mode=="graduation"||this.mode=="storyboard"?this.mode:this.mode=="osu"?"osu!":"osu!"+this.mode}},watch:{selectedUser(){this.loadExtraMentees()}},mounted(){this.loadExtraMentees()},methods:{async loadExtraMentees(){if(this.extraMentees=[],this.selectedUser.mentorships){const e=this.selectedUser.mentorships.filter(t=>{if(t.group=="extraMentor"&&t.mode==this.mode)return!0});for(const t of e){const o=await this.$http.executeGet(`/mentorship/findExtraMentees/${t.cycle.id}/${this.selectedUser.id}/${this.mode}`);this.$http.isError(o)||(this.extraMentees=o)}}},calculateDuration(e){let t=0;for(const o of e)if(new Date>new Date(o.cycle.endDate)){const i=new Date(o.cycle.endDate).getTime()-new Date(o.cycle.startDate).getTime(),m=Math.round(i*(o.phases.length/3)/(1e3*60*60*24));t+=m}return t},findRelevantMentees(e){const t=this.selectedUser.mentees.filter(o=>{for(const i of o.mentorships)if(i.cycle.toString()==e.cycle.id&&i.group=="mentee"&&i.mode==this.mode&&i.mentor.toString()==this.selectedUser.id)return!0});if(this.extraMentees&&this.extraMentees.length)for(const o of this.extraMentees)for(const i of o.mentorships)i.cycle.toString()==e.cycle.id&&i.group=="mentee"&&i.mode==this.mode&&i.mentor.toString()==e.mentor.id&&t.push(o);return t}}}),Kt={key:0,class:"col-sm-3"},Rt={class:"text-center"},Gt=["href"],jt={class:"small text-secondary"},zt={key:0},Ft={class:"small text-secondary"},qt={key:1};function Ht(e,t,o,i,m,y){const r=_("user-link");return e.modeMentorships.length?(l(),a("div",Kt,[s("div",Rt,[s("b",{class:U(e.modeMentorships.length>=4&&e.group=="mentee"?"text-danger":"")},h(e.title)+" "+h(e.group)+" cycles ("+h(e.mentorshipsToPhases)+")",3)]),s("ul",null,[(l(!0),a(I,null,M(e.modeMentorships,n=>(l(),a("li",{key:n.id+e.mode},[s("a",{href:n.cycle.url,target:"_blank"},h(n.cycle.number)+": "+h(n.cycle.name),9,Gt),s("span",jt," ("+h(e.calculateDuration([n]))+" days) ",1),n.mentor&&n.group!="extraMentor"?(l(),a("ul",zt,[s("li",Ft,[C(" mentored by "),d(r,{user:n.mentor},null,8,["user"])])])):g("",!0),e.group=="mentor"&&e.findRelevantMentees(n).length?(l(),a("ul",qt,[(l(!0),a(I,null,M(e.findRelevantMentees(n),v=>(l(),a("li",{key:v.id+e.mode+n.cycle.id,class:"small text-secondary"},[C(" mentor of "),d(r,{user:v},null,8,["user"])]))),128))])):g("",!0)]))),128))])])):g("",!0)}const Jt=D(Lt,[["render",Ht]]),Ot=w({name:"UserDetails",components:{CycleList:Jt},data(){return{userInput:""}},computed:{...k("mentorship",["selectedUser"]),totalMentorDuration(){const t=this.selectedUser.mentorships.filter(y=>{if(y.group=="mentor"||y.group=="extraMentor")return!0}).reduce((y,r)=>(y.some(n=>n.cycle.id===r.cycle.id)||y.push(r),y),[]),o=this.calculateDuration(t);let i=Math.floor(o/365),m=Math.round(o%365);return i>0?`${i} ${i==1?"year":"years"} and ${m} days`:`${m} days`},totalMenteeDuration(){const t=this.selectedUser.mentorships.filter(y=>{if(y.group=="mentee")return!0}).reduce((y,r)=>(y.some(n=>n.cycle.id===r.cycle.id)||y.push(r),y),[]),o=this.calculateDuration(t);let i=Math.floor(o/365),m=Math.round(o%365);return i>0?`${i} ${i==1?"year":"years"}, ${m} days`:`${m} days`}},beforeCreate(){this.$store.hasModule("mentorship")||this.$store.registerModule("mentorship",P)},methods:{async searchUser(e){const t=await this.$http.executeGet("/mentorship/searchUser/"+this.userInput,e);this.$http.isError(t)||this.$store.commit("mentorship/setSelectedUser",t)},calculateDuration(e){let t=0;for(const o of e)if(new Date>new Date(o.cycle.endDate)){const i=new Date(o.cycle.endDate).getTime()-new Date(o.cycle.startDate).getTime(),m=Math.round(i*(o.phases.length/3)/(1e3*60*60*24));t+=m}return t}}}),Qt={class:"container card card-body py-3"},Wt=s("h5",null,"User Details",-1),Xt=s("div",{class:"text-secondary mb-2"}," View a user's mentorship history ",-1),Yt={class:"input-group w-25"},Zt={class:"input-group-append"},xt=s("i",{class:"fas fa-search fa-xs"},null,-1),es=[xt],ts={key:0},ss={class:"mt-2"},os={class:"row mt-2"},ns={key:0},rs={class:"row mt-2"};function is(e,t,o,i,m,y){const r=_("cycle-list");return l(),a("div",null,[s("div",Qt,[Wt,Xt,s("div",Yt,[f(s("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>e.userInput=n),class:"form-control form-control-sm",autocomplete:"off",placeholder:"username/osuId...",onKeyup:t[1]||(t[1]=T(n=>e.searchUser(n),["enter"]))},null,544),[[$,e.userInput]]),s("div",Zt,[s("button",{class:"btn btn-primary",href:"#",onClick:t[2]||(t[2]=p(n=>e.searchUser(n),["prevent"]))},es)])]),e.selectedUser?(l(),a("div",ts,[s("div",ss,[C(" Mentor for "),s("b",null,h(e.totalMentorDuration),1),C(" across all cycles and game modes ")]),s("div",os,[d(r,{mode:"osu",group:"mentor"}),d(r,{mode:"taiko",group:"mentor"}),d(r,{mode:"catch",group:"mentor"}),d(r,{mode:"mania",group:"mentor"}),d(r,{mode:"modding",group:"mentor"}),d(r,{mode:"graduation",group:"mentor"}),d(r,{mode:"storyboard",group:"mentor"})]),e.totalMenteeDuration!=="0 days"?(l(),a("div",ns,[C(" Mentee for "),s("b",null,h(e.totalMenteeDuration),1),C(" across all cycles and game modes ")])):g("",!0),s("div",rs,[d(r,{mode:"osu",group:"mentee"}),d(r,{mode:"taiko",group:"mentee"}),d(r,{mode:"catch",group:"mentee"}),d(r,{mode:"mania",group:"mentee"}),d(r,{mode:"modding",group:"mentee"}),d(r,{mode:"graduation",group:"mentee"}),d(r,{mode:"storyboard",group:"mentee"})])])):g("",!0)])])}const ls=D(Ot,[["render",is]]),as=w({name:"TenureBadges",data(){return{clicked:!1}},computed:{...k(["loggedInUser"]),...E("mentorship",["badgeUsers"])},beforeCreate(){this.$store.hasModule("mentorship")||this.$store.registerModule("mentorship",P)},methods:{async loadTenureBadges(e){const t=await this.$http.executeGet("/mentorship/loadTenureBadges",e);this.$http.isError(t)||(this.$store.dispatch("updateToastMessages",{message:"loaded",type:"info"}),this.$store.commit("mentorship/setBadgeUsers",t.users))},async editBadgeValue(e,t){this.clicked=!0;const o=await this.$http.executePost("/mentorship/editBadgeValue",{userId:e,value:t});this.$http.isError(o)||(await this.loadTenureBadges(null),this.$store.dispatch("updateToastMessages",{message:"updated",type:"info"})),this.clicked=!1}}});const A=e=>(V("data-v-f1860f31"),e=e(),B(),e),ds={class:"container card card-body py-3 mt-2"},cs=A(()=>s("h5",null,"Tenure Badges",-1)),us={key:1},ps=A(()=>s("span",{class:"text-secondary"},"Badge:",-1)),ms=["onClick"],hs=A(()=>s("i",{class:"fas fa-plus ms-1 text-success"},null,-1)),ys=[hs],fs=["onClick"],$s=A(()=>s("i",{class:"fas fa-minus ms-1 text-danger"},null,-1)),gs=[$s],_s=A(()=>s("span",{class:"text-secondary"},"Actual tenure:",-1));function vs(e,t,o,i,m,y){const r=_("user-link");return l(),a("div",null,[s("div",ds,[cs,e.badgeUsers.length?(l(),a("ul",us,[(l(!0),a(I,null,M(e.badgeUsers,n=>(l(),a("li",{key:n.id},[d(r,{user:n},null,8,["user"]),s("ul",null,[s("li",null,[ps,C(),s("b",null,h(n.mentorshipBadge),1),s("a",{href:"#",class:U(e.clicked?"fake-button-disable":""),onClick:p(v=>e.editBadgeValue(n._id,!0),["prevent"])},ys,10,ms),s("a",{href:"#",class:U(e.clicked?"fake-button-disable":""),onClick:p(v=>e.editBadgeValue(n._id,!1),["prevent"])},gs,10,fs)]),s("li",null,[_s,C(),s("b",null,h(n.actualTenure),1)])])]))),128))])):(l(),a("button",{key:0,class:"btn btn-primary",href:"#",onClick:t[0]||(t[0]=p(n=>e.loadTenureBadges(n,null),["prevent"]))}," Load badges "))])])}const Cs=D(as,[["render",vs],["__scopeId","data-v-f1860f31"]]),bs=w({name:"MentorshipPage",components:{Administrators:Y,Cycles:pe,Participants:Bt,UserDetails:ls,AddUserManually:R,TenureBadges:Cs},data(){return{userInput:null,confirmDelete:null}},computed:{...k(["loggedInUser"]),...E("mentorship",["allCycles"])},beforeCreate(){this.$store.hasModule("mentorship")||this.$store.registerModule("mentorship",P)},async created(){const e=await this.$http.initialRequest("/mentorship/query");this.$http.isError(e)||(this.$store.commit("mentorship/setAdmins",e.admins),this.$store.commit("mentorship/setCycles",e.cycles))},methods:{}}),Is=s("hr",null,null,-1);function Ms(e,t,o,i,m,y){const r=_("participants"),n=_("user-details"),v=_("cycles"),c=_("administrators"),u=_("add-user-manually"),b=_("tenure-badges");return l(),a("div",null,[d(r),d(n),Is,d(v),d(c),d(u),d(b)])}const Us=D(bs,[["render",Ms]]);export{Us as default};

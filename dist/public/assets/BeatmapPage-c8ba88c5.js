import{d as v,_ as y,o as i,e as l,a as n,b as O,f as A,i as u,w as p,F as _,r as k,j as h,t as d,k as I,p as f,g as N,y as g,n as b,M as D,m as E,c as M}from"./index-eb01d7f8.js";import{C}from"./CopyPaste-82a57233.js";import{B as G}from"./BeatmapInfoAdmin-29b31aa3.js";import{D as T}from"./DataTable-f14927db.js";import"./ModalDialog-eee53abc.js";import"./task-21eeb954.js";import"./TasksChoice-6147faf7.js";const P=v({name:"ContributorStats",components:{CopyPaste:C},data(){return{date:"2022-07-24",externalBeatmaps:[],users:[]}},methods:{async loadNewsInfo(t){const s=await this.$http.executeGet("/admin/beatmaps/loadNewsInfo/"+this.date,t);s&&(this.users=s.users)},separateCommas(t,s){return t<s-1?", ":""}}}),V={class:"container card card-body py-3 mt-2"},R=n("h5",null,"Mappers' Guild contributor stats",-1),Y={class:"form-inline"},K={class:"form-group"},W={key:0},j=n("p",null," Users with ranked maps/tasks: ",-1),H=n("div",null," | User | Modes | Ranked beatmaps | Ranked difficulties | ",-1),z=n("div",null," | :-- | :-- | :-- | :-- | ",-1);function q(t,s,a,o,B,$){const r=f("copy-paste");return i(),l("div",V,[R,n("div",Y,[n("div",K,[n("button",{class:"btn btn-sm btn-info",onClick:s[0]||(s[0]=e=>t.loadNewsInfo(e))}," Generate Mappers' Guild contributors stats "),O(n("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>t.date=e),class:"form-control form-control-sm d-inline mx-2 w-25",type:"text",autocomplete:"off",placeholder:"YYYY-MM-DD"},null,512),[[A,t.date]])])]),t.users&&t.users.length?(i(),l("div",W,[j,u(r,{distinct:"users"},{default:p(()=>[H,z,(i(!0),l(_,null,k(t.users,e=>(i(),l("div",{key:e.id},[h(" | "+d(e.flag)+" ["+d(e.username)+"]("+d("https://osu.ppy.sh/users/"+e.osuId)+") | ",1),(i(!0),l(_,null,k(e.modes,(c,w)=>(i(),l("span",{key:c},d(c=="osu"?"osu!":c=="sb"?"Storyboarder":c=="hs"?"Hitsounder":"osu!"+c)+d(t.separateCommas(w,e.modes.length)),1))),128)),h(" | "+d(e.hostCount)+" | "+d(e.taskCount)+" | ",1)]))),128))]),_:1})])):I("",!0)])}const J=y(P,[["render",q]]),Q=v({name:"OsuApiBeatmapSearch",components:{CopyPaste:C},data(){return{osuId:null,output:null}},methods:{async searchBeatmap(t){const s=await this.$http.executePost("/admin/beatmaps/searchBeatmap",{osuId:this.osuId},t);s&&!s.error&&(this.output=s)}}}),X={class:"container card card-body py-1"},Z=n("h5",{class:"mt-2"}," Search beatmap in osu! API ",-1),x={key:0};function tt(t,s,a,o,B,$){const r=f("copy-paste");return i(),l("div",X,[Z,O(n("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>t.osuId=e),class:"form-control form-control-sm mb-2",type:"text",maxlength:"18",autocomplete:"off",placeholder:"search by osuID...",onKeyup:s[1]||(s[1]=N(e=>t.searchBeatmap(e),["enter"]))},null,544),[[A,t.osuId]]),n("button",{class:"btn btn-sm w-100 btn-info mb-2",onClick:s[2]||(s[2]=e=>t.searchBeatmap(e))}," Load beatmap "),t.output?(i(),l("div",x,[u(r,null,{default:p(()=>[n("pre",null,d(t.output),1)]),_:1})])):I("",!0)])}const et=y(Q,[["render",tt]]),st=v({name:"BundledBeatmapsList",components:{CopyPaste:C},data(){return{bundledBeatmaps:[]}},computed:{osuBeatmaps(){return this.bundledBeatmaps.filter(t=>t.mode=="osu")},taikoBeatmaps(){return this.bundledBeatmaps.filter(t=>t.mode=="taiko")},catchBeatmaps(){return this.bundledBeatmaps.filter(t=>t.mode=="catch")},maniaBeatmaps(){return this.bundledBeatmaps.filter(t=>t.mode=="mania")},osuFinalBeatmaps(){return this.bundledBeatmaps.filter(t=>t.mode=="osu"&&t.isBundled)},taikoFinalBeatmaps(){return this.bundledBeatmaps.filter(t=>t.mode=="taiko"&&t.isBundled)},catchFinalBeatmaps(){return this.bundledBeatmaps.filter(t=>t.mode=="catch"&&t.isBundled)},maniaFinalBeatmaps(){return this.bundledBeatmaps.filter(t=>t.mode=="mania"&&t.isBundled)}},methods:{async findBundledBeatmaps(t){const s=await this.$http.executeGet("/admin/beatmaps/findBundledBeatmaps",t);s&&!s.error&&(this.bundledBeatmaps=s)},async toggleIsBundled(t,s){const a=await this.$http.executePost("/admin/beatmaps/"+t+"/toggleIsBundled",{isBundled:s});if(!this.$http.isError(a)){const o=[...this.bundledBeatmaps],B=o.findIndex($=>$.id==t);o[B]=a,this.bundledBeatmaps=o}},findOsuId(t){const s=t.indexOf("beatmapsets/")+12,a=t.indexOf("#");let o="";return a!==-1?o=t.slice(s,a):o=t.slice(s),parseInt(o,10)}}}),nt={class:"container card card-body py-3 mt-2"},at=n("h5",null,"Bundled beatmap list generator",-1),ot={key:0,class:"row mt-3 small"},it={class:"col-sm-6"},dt=["onClick"],lt=["href"],rt={class:"col-sm-6"},ut=["onClick"],ct=["href"],mt={class:"col-sm-6"},pt=["onClick"],ft=["href"],ht={class:"col-sm-6"},Bt=["onClick"],_t=["href"],kt=n("p",null,"final lists",-1),gt={class:"row"},bt={class:"col-sm-3"},It=["href"],$t=["onClick"],vt={class:"col-sm-3"},yt=["href"],Ct=["onClick"],wt={class:"col-sm-3"},Mt=["href"],Ot=["onClick"],At={class:"col-sm-3"},Lt=["href"],Ft=["onClick"];function St(t,s,a,o,B,$){const r=f("copy-paste");return i(),l("div",nt,[at,n("button",{class:"btn btn-sm w-100 btn-info",onClick:s[0]||(s[0]=e=>t.findBundledBeatmaps(e))}," Load beatmaps with ENHI+ spreads "),t.bundledBeatmaps.length?(i(),l("div",ot,[n("div",it,[h(" osu ("+d(t.osuBeatmaps.length)+") ",1),u(r,{distinct:"osu"},{default:p(()=>[(i(!0),l(_,null,k(t.osuBeatmaps,e=>(i(),l("div",{key:e.id},[n("a",{href:"#",class:"me-1",onClick:g(c=>t.toggleIsBundled(e.id,e.isBundled),["stop","prevent"])},[n("i",{class:b(["fas",e.isBundled?"text-done fa-check":"text-danger fa-times"])},null,2)],8,dt),n("a",{href:e.url,target:"_blank"},d(e.song.artist+" - "+e.song.title)+" ("+d(t.findOsuId(e.url))+")",9,lt)]))),128))]),_:1})]),n("div",rt,[h(" taiko ("+d(t.taikoBeatmaps.length)+") ",1),u(r,{distinct:"taiko"},{default:p(()=>[(i(!0),l(_,null,k(t.taikoBeatmaps,e=>(i(),l("div",{key:e.id},[n("a",{href:"#",class:"me-1",onClick:g(c=>t.toggleIsBundled(e.id,e.isBundled),["stop","prevent"])},[n("i",{class:b(["fas",e.isBundled?"text-done fa-check":"text-danger fa-times"])},null,2)],8,ut),n("a",{href:e.url,target:"_blank"},d(e.song.artist+" - "+e.song.title)+" ("+d(t.findOsuId(e.url))+")",9,ct)]))),128))]),_:1})]),n("div",mt,[h(" catch ("+d(t.catchBeatmaps.length)+") ",1),u(r,{distinct:"catch"},{default:p(()=>[(i(!0),l(_,null,k(t.catchBeatmaps,e=>(i(),l("div",{key:e.id},[n("a",{href:"#",class:"me-1",onClick:g(c=>t.toggleIsBundled(e.id,e.isBundled),["stop","prevent"])},[n("i",{class:b(["fas",e.isBundled?"text-done fa-check":"text-danger fa-times"])},null,2)],8,pt),n("a",{href:e.url,target:"_blank"},d(e.song.artist+" - "+e.song.title)+" ("+d(t.findOsuId(e.url))+")",9,ft)]))),128))]),_:1})]),n("div",ht,[h(" mania ("+d(t.maniaBeatmaps.length)+") ",1),u(r,{distinct:"mania"},{default:p(()=>[(i(!0),l(_,null,k(t.maniaBeatmaps,e=>(i(),l("div",{key:e.id},[n("a",{href:"#",class:"me-1",onClick:g(c=>t.toggleIsBundled(e.id,e.isBundled),["stop","prevent"])},[n("i",{class:b(["fas",e.isBundled?"text-done fa-check":"text-danger fa-times"])},null,2)],8,Bt),n("a",{href:e.url,target:"_blank"},d(e.song.artist+" - "+e.song.title)+" ("+d(t.findOsuId(e.url))+")",9,_t)]))),128))]),_:1})]),kt,n("div",gt,[n("div",bt,[h(" osu ("+d(t.osuFinalBeatmaps.length)+") ",1),u(r,{distinct:"osufinal"},{default:p(()=>[(i(!0),l(_,null,k(t.osuFinalBeatmaps,e=>(i(),l("div",{key:e.id},[n("a",{href:e.url,target:"_blank",class:"me-1"},d(t.findOsuId(e.url)),9,It),n("a",{href:"#",onClick:g(c=>t.toggleIsBundled(e.id,e.isBundled),["stop","prevent"])},[n("i",{class:b(["fas",e.isBundled?"text-done fa-check":"text-danger fa-times"])},null,2)],8,$t)]))),128))]),_:1})]),n("div",vt,[h(" taiko ("+d(t.taikoFinalBeatmaps.length)+") ",1),u(r,{distinct:"taiko"},{default:p(()=>[(i(!0),l(_,null,k(t.taikoFinalBeatmaps,e=>(i(),l("div",{key:e.id},[n("a",{href:e.url,target:"_blank",class:"me-1"},d(t.findOsuId(e.url)),9,yt),n("a",{href:"#",onClick:g(c=>t.toggleIsBundled(e.id,e.isBundled),["stop","prevent"])},[n("i",{class:b(["fas",e.isBundled?"text-done fa-check":"text-danger fa-times"])},null,2)],8,Ct)]))),128))]),_:1})]),n("div",wt,[h(" catch ("+d(t.catchFinalBeatmaps.length)+") ",1),u(r,{distinct:"catch"},{default:p(()=>[(i(!0),l(_,null,k(t.catchFinalBeatmaps,e=>(i(),l("div",{key:e.id},[n("a",{href:e.url,target:"_blank",class:"me-1"},d(t.findOsuId(e.url)),9,Mt),n("a",{href:"#",onClick:g(c=>t.toggleIsBundled(e.id,e.isBundled),["stop","prevent"])},[n("i",{class:b(["fas",e.isBundled?"text-done fa-check":"text-danger fa-times"])},null,2)],8,Ot)]))),128))]),_:1})]),n("div",At,[h(" mania ("+d(t.maniaFinalBeatmaps.length)+") ",1),u(r,{distinct:"mania"},{default:p(()=>[(i(!0),l(_,null,k(t.maniaFinalBeatmaps,e=>(i(),l("div",{key:e.id},[n("a",{href:e.url,target:"_blank",class:"me-1"},d(t.findOsuId(e.url)),9,Lt),n("a",{href:"#",onClick:g(c=>t.toggleIsBundled(e.id,e.isBundled),["stop","prevent"])},[n("i",{class:b(["fas",e.isBundled?"text-done fa-check":"text-danger fa-times"])},null,2)],8,Ft)]))),128))]),_:1})])])])):I("",!0)])}const Ut=y(st,[["render",St]]),Nt=v({name:"BeatmapIdListGenerator",components:{CopyPaste:C},data(){return{inputUrls:"",output:""}},methods:{findOsuId(t){const s=t.indexOf("beatmapsets/")+12,a=t.indexOf("#");let o="";return a!==-1?o=t.slice(s,a):o=t.slice(s),parseInt(o,10)},generateBeatmapCommaIdList(){let t="";const s=this.inputUrls.split(`
`);for(const a of s){const o=this.findOsuId(a);isNaN(o)?t+=`FAILED (${a})`:t+=o,t+=","}this.output=t.substring(0,t.length-1)},generateBeatmapNewLineIdList(){let t="";const s=this.inputUrls.split(`
`);for(const a of s){const o=this.findOsuId(a);isNaN(o)?t+=`FAILED (${a})`:t+=o,t+=`
`}this.output=t.substring(0,t.length-1)}}}),Dt={class:"container card card-body py-3 mt-2"},Et=n("h5",null,"Beatmap pack ID list generator",-1),Gt={class:"form-inline"},Tt={class:"form-group"},Pt={key:0};function Vt(t,s,a,o,B,$){const r=f("copy-paste");return i(),l("div",Dt,[Et,O(n("textarea",{"onUpdate:modelValue":s[0]||(s[0]=e=>t.inputUrls=e),class:"form-control form-control-sm mx-2 mb-2 w-100",type:"text",autocomplete:"off",placeholder:"map URLs separated by newlines..."},null,512),[[A,t.inputUrls]]),n("div",Gt,[n("div",Tt,[n("button",{class:"btn btn-sm btn-info me-2",onClick:s[1]||(s[1]=e=>t.generateBeatmapCommaIdList())}," Generate (comma separated) "),n("button",{class:"btn btn-sm btn-info",onClick:s[2]||(s[2]=e=>t.generateBeatmapNewLineIdList())}," Generate (newlines) ")])]),t.output.length?(i(),l("div",Pt,[u(r,null,{default:p(()=>[h(d(t.output),1)]),_:1})])):I("",!0)])}const Rt=y(Nt,[["render",Vt]]),Yt={state:{beatmaps:[]},mutations:{setBeatmaps(t,s){t.beatmaps=s},updateBeatmap(t,s){const a=t.beatmaps.findIndex(o=>o.id===s.id);a!==-1&&(t.beatmaps[a]=s)},updateBeatmapStatus(t,s){const a=t.beatmaps.find(o=>o.id==s.beatmapId);a&&(a.status=s.status)},deleteTask(t,s){const a=t.beatmaps.find(o=>o.id==s.beatmapId);if(a){const o=a.tasks.findIndex(B=>B.id==s.taskId);o!==-1&&a.tasks.splice(o,1)}},deleteModder(t,s){const a=t.beatmaps.find(o=>o.id==s.beatmapId);if(a){const o=a.modders.findIndex(B=>B.id==s.modderId);o!==-1&&a.modders.splice(o,1)}},updateUrl(t,s){const a=t.beatmaps.find(o=>o.id==s.beatmapId);a&&(a.url=s.url)},updatePackId(t,s){const a=t.beatmaps.find(o=>o.id==s.beatmapId);a&&(a.packId=s.packId)},updateIsShowcase(t,s){const a=t.beatmaps.find(o=>o.id==s.beatmapId);a&&(a.isShowcase=s.isShowcase)},updateIsWorldCup(t,s){const a=t.beatmaps.find(o=>o.id==s.beatmapId);a&&(a.isWorldCup=s.isWorldCup)}}},Kt=Yt,Wt=v({components:{ContributorStats:J,DataTable:T,BeatmapInfoAdmin:G,OsuApiBeatmapSearch:et,BundledBeatmapsList:Ut,BeatmapIdListGenerator:Rt,ModesIcons:D},data(){return{selectedBeatmapId:""}},computed:{...E({beatmaps:t=>t.beatmapsAdmin.beatmaps}),selectedBeatmap(){return this.beatmaps.find(t=>t.id===this.selectedBeatmapId)}},beforeCreate(){this.$store.hasModule("beatmapsAdmin")||this.$store.registerModule("beatmapsAdmin",Kt)},unmounted(){this.$store.hasModule("beatmapsAdmin")&&this.$store.unregisterModule("beatmapsAdmin")},methods:{async loadBeatmaps(t){const s=await this.$http.executeGet("/admin/beatmaps/load",t);this.$http.isError(s)||this.$store.commit("setBeatmaps",s)},updateBeatmap(t){const s=this.beatmaps.findIndex(a=>a.id==t.id);s!==-1&&(this.beatmaps[s]=t)},formatMetadata(t){if(!t)return"";let s=t.artist+" - ";return t.title.length>40?s+=t.title.slice(0,40)+"...":s+=t.title,s}}}),jt={class:"container card card-body py-3"},Ht=n("h5",null,"Beatmaps list",-1),zt={class:"text-truncate"},qt=["href"],Jt={key:1,class:"ms-1"};function Qt(t,s,a,o,B,$){const r=f("modes-icons"),e=f("user-link"),c=f("data-table"),w=f("beatmap-info-admin"),L=f("osu-api-beatmap-search"),F=f("contributor-stats"),S=f("bundled-beatmaps-list"),U=f("beatmap-id-list-generator");return i(),l("div",null,[n("div",jt,[Ht,n("button",{class:"btn btn-sm btn-info w-100",onClick:s[0]||(s[0]=m=>t.loadBeatmaps(m))}," Load all beatmaps "),t.beatmaps.length?(i(),M(c,{key:0,data:t.beatmaps,headers:["METADATA","PACK ID","CREATOR","STATUS"],"custom-data-target":"#editBeatmap","onUpdate:selectedId":s[1]||(s[1]=m=>t.selectedBeatmapId=m)},{default:p(({obj:m})=>[n("td",zt,[u(r,{modes:[m.mode]},null,8,["modes"]),m.url?(i(),l("a",{key:0,href:m.url,class:"ms-1"},d(t.formatMetadata(m.song)),9,qt)):(i(),l("span",Jt,d(t.formatMetadata(m.song)),1))]),n("td",null,d(m.packId),1),n("td",null,[m.host?(i(),M(e,{key:0,user:m.host},null,8,["user"])):I("",!0)]),n("td",null,d(m.status),1)]),_:1},8,["data"])):I("",!0)]),t.selectedBeatmap?(i(),M(w,{key:0,beatmap:t.selectedBeatmap,onUpdateBeatmap:s[2]||(s[2]=m=>t.updateBeatmap(m))},null,8,["beatmap"])):I("",!0),u(L,{class:"mt-2"}),u(F),u(S),u(U)])}const ae=y(Wt,[["render",Qt]]);export{ae as default};

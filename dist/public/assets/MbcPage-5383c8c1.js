import{d as S,_ as k,o as d,e as c,a as l,n as M,z as g,j as D,t as b,k as f,u as T,x as y,i as j,q as I}from"./index-c0588d7c.js";const L=S({name:"TaikoAverageSv",data(){return{isDragOver:!1,error:"",output:""}},methods:{handleDragOver(){this.isDragOver=!0},handleDragEnter(){this.isDragOver=!0},handleDragLeave(){this.isDragOver=!1},handleDrop(e){this.isDragOver=!1;const t=e.dataTransfer.files;this.processFiles(t)},extractMode(e){var t;for(const n of e){const s=n.trim();if(s.startsWith("Mode:")){const i=(t=s.split(":")[1])==null?void 0:t.trim(),r=parseInt(i,10);return isNaN(r)?null:r}}return null},extractSections(e){const t=[],n=[];let s=null;for(const i of e){const r=i.trim();if(r==="[TimingPoints]"){s="timing";continue}else if(r==="[HitObjects]"){s="hitobjects";continue}else if(/^\[.+\]$/.test(r)){s=null;continue}s==="timing"?r!==""&&t.push(r):s==="hitobjects"&&r!==""&&n.push(r)}return{timingLines:t.join(`
`),hitObjectLines:n.join(`
`)}},extractSVMultipliers(e){return e.split(`
`).map(t=>t.trim()).filter(t=>t.length>0).map(t=>{const n=t.split(","),s=parseInt(n[0],10),i=parseFloat(n[1]);if(parseInt(n[6],10)===0){const a=-100/i;return{time:s,svMultiplier:a}}return null}).filter(t=>t!==null)},parseHitObjectTimes(e){return e.split(`
`).map(t=>t.trim()).filter(t=>t.length>0).map(t=>{const n=t.split(",");return parseInt(n[2],10)})},filterUnusedInheritedTimingPoints(e,t){e.sort((s,i)=>s.time-i.time),t.sort((s,i)=>s-i);const n=new Set;for(const s of t){let i=null;for(const r of e)if(r.time<=s)i=r;else break;i&&n.add(i.time)}return e.filter(s=>n.has(s.time))},processFiles(e){if(e.length>0){const t=e[0],n=new FileReader;n.onload=s=>{if(s.target&&s.target.result){this.error="",this.output="";const r=s.target.result.split(`\r
`);if(this.extractMode(r)!==1){this.error="Not an osu!taiko beatmap!";return}const{timingLines:p,hitObjectLines:u}=this.extractSections(r),h=this.extractSVMultipliers(p),o=this.parseHitObjectTimes(u),_=this.filterUnusedInheritedTimingPoints(h,o),m=Math.round(_.reduce((O,$)=>O+$.svMultiplier,0)/(_.length||1)*100)/100;m<.95||m>1.05?this.error=`Average SV: ${m.toFixed(2)} (not eligible)`:this.output=`Average SV: ${m.toFixed(2)} (eligible)`}},n.readAsText(t)}}}});const v=e=>(T("data-v-041a8109"),e=e(),y(),e),V=v(()=>l("h4",null,"Monthly Beatmapping Contest: July 2025 (osu!taiko)",-1)),C=v(()=>l("h5",null,"Confirm if the average SV of your map is between 0.95 and 1.05",-1)),N={class:"row"},w={class:"col-sm-12"},A=v(()=>l("code",null,".osu",-1)),F={key:0,class:"col-sm-12 d-flex align-items-center"},x={key:0,class:"text-success"},B={key:1,class:"text-danger"};function E(e,t,n,s,i,r){var a,p,u,h;return d(),c("div",null,[V,C,l("div",N,[l("div",w,[l("div",{class:M(["drop ms-4 my-4",e.isDragOver?"bg-dark":""]),onDragover:t[0]||(t[0]=g((...o)=>e.handleDragOver&&e.handleDragOver(...o),["prevent"])),onDragenter:t[1]||(t[1]=g((...o)=>e.handleDragEnter&&e.handleDragEnter(...o),["prevent"])),onDragleave:t[2]||(t[2]=g((...o)=>e.handleDragLeave&&e.handleDragLeave(...o),["prevent"])),onDrop:t[3]||(t[3]=g((...o)=>e.handleDrop&&e.handleDrop(...o),["prevent"]))},[D(" Drop a "),A,D(" file here ")],34)]),(a=e.output)!=null&&a.length||(p=e.error)!=null&&p.length?(d(),c("div",F,[(u=e.output)!=null&&u.length?(d(),c("pre",x,b(e.output),1)):f("",!0),(h=e.error)!=null&&h.length?(d(),c("pre",B,b(e.error),1)):f("",!0)])):f("",!0)])])}const H=k(L,[["render",E],["__scopeId","data-v-041a8109"]]),P=S({name:"MbcPage",components:{TaikoAverageSv:H}}),z={class:"container card card-body py-1"},U={class:"p-3"};function q(e,t,n,s,i,r){const a=I("taiko-average-sv");return d(),c("div",z,[l("div",U,[j(a)])])}const R=k(P,[["render",q]]);export{R as default};
